= 前提知識

== 3 （ n ）層（ Tier ）アーキテクチャ

古くから Web アプリケーションなどで使われている一般的な構造

物理的に分けることが可能な「層」

アプリケーション内での論理的な分割である 3 レイヤー（ Layer 、層）アーキテクチャや
ヘキサゴナルアーキテクチャの前提となっているレイヤードアーキテクチャと構造や用語が似ており混同を
避けるために紹介する。



.層（ Tier ）とレイヤー（ Layer ）
[quote, IBM, 'https://www.ibm.com/jp-ja/topics/three-tier-architecture[3層アーキテクチャーとは]']
____
層とレイヤーは同じではありません。 「レイヤー」とは、ソフトウェアの機能部を指しますが、
「層」とは、他の部分から分離してインフラストラクチャーで実行されるソフトウェアの機能部を指します。 
例えば、電話の連絡先アプリは、3レイヤー・アプリケーションですが、3つのレイヤーがすべてその電話上で機能するため、1層 のアプリケーションです。
____




プレゼンテーション層

プレゼンテーション層とは、アプリケーションのユーザー・インターフェースかつアプリケーションの通信層であり、エンド・ユーザーはこの層でアプリケーションと対話します。 その主な目的は、ユーザーに情報を表示し、情報をユーザーから収集することです。 この第1層は、デスクトップ・アプリケーションであるWebブラウザー、またはグラフィカル・ユーザー・インターフェース（GUI）などで実行できます。 Webプレゼンテーション層は通常、HTML、CSS 、JavaScriptを使用して開発されます。 デスクトップ・アプリケーションは、プラットフォームに応じてさまざまな言語で記述することができます。
アプリケーション層

アプリケーション層（論理層または中間層とも呼ばれます）は、アプリケーションの中核です。 この層では、プレゼンテーション層で収集された情報が、特定のビジネス・ルールのセットであるビジネス・ロジックを使用して処理されます（データ層の他の情報に対して処理される場合もあります）。 アプリケーション層は、データ層内でデータの追加、削除、または変更を行うこともできます。 

データ層

データ層（データベース層、データ・アクセス層、またはバックエンドと呼ばれることもあります）は、アプリケーションによって処理された情報が保管され、管理される場所です。 これは、PostgreSQL、MySQL、MariaDB、Oracle、Db2、Informix、Microsoft SQL Serverなどのリレーショナル・データベース管理システムである場合、またはCassandra、CouchDB、MongoDBなどのNoSQLデータベース・サーバー内にある場合があります。          

3層アプリケーションでは、すべての通信がアプリケーション層を経由します。 プレゼンテーション層とデータ層は、相互に直接通信できません。

Web アプリケーションの例




3 レイヤー（ Layer ）アーキテクチャ（アプリケーション層の中の話）
レイヤードアーキテクチャ（ドメインの概念の登場）




== ドメイン駆動設計



入力側や出力側という表現だけではイメージしやすいかもしれないが、
入力へのレスポンスや出力されたデータの参照などが分かりにくくなるため、
公式の例のようにユーザサイドやデータサイド、オニオンアーキテクチャなどの U/I やインフラストラクチャなどの表現の方が良さそう
クリーンアーキテクチャだとコントローラーが入力とプレゼンテーターが出力となってデバイスを通してインフラストラクチャにアクセス
しそうに見える

ポート アプリケーション境界の内外のやり取りに利用
ユースケース アプリケーション境界上の内側に存在
ユースケースをポート（アプリケーション境界そのもの）の一部とするか、ポートとは区切られた内側の層とするか？
＝＞ クリーンアーキテクチャだと、境界線そのものがユースケース層であり、入力／出力ポートとインターアクターが存在する。
よって、ポートの一部と見るのが自然っぽい。ただし、外側とやり取りするのは入出力ポートの役割



アプリケーション



アプリケーションの具体化

オニオンアーキテクチャ

クリーンアーキテクチャ



ドメイン駆動設計（ DDD ）との関係

ドメインとは






依存方向
依存関係の逆転
自分と同じ層とさらに内側しか知らない。
知らないものが変更されても何も影響は受けずに済む。
セカンダリ側だと処理の流れと依存関係が逆になるが、そこはインターフェースを介して実装に処理を
渡すことで解消できる



実装順

アダプタやポートはテスト用から

